{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport io from 'socket.io-client';\nexport function useAddMessage() {\n  _s();\n  const {\n    chatId\n  } = useParams();\n  const addMessage = async message => {\n    try {\n      const authToken = localStorage.getItem('token');\n      const response = await fetch('http://localhost:8000/api/v1/message/addmessage', {\n        method: 'POST',\n        headers: {\n          'content-type': 'application/json',\n          'authorization': `Bearer ${authToken}`\n        },\n        body: JSON.stringify({\n          content: message,\n          chat: chatId\n        })\n      });\n      if (response.ok) {\n        return await response.json();\n      }\n      throw new Error('Failed to add message');\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  return {\n    addMessage\n  };\n}\n_s(useAddMessage, \"LqKMzoXRAqQh4iGtGZmTAreYw1A=\", false, function () {\n  return [useParams];\n});\nexport function useFetchMsg() {\n  _s2();\n  const [allMsg, setAllMsg] = useState([]);\n  const {\n    chatId\n  } = useParams();\n  const authToken = localStorage.getItem('token');\n  const socket = io('http://localhost:8000');\n  const fetchMsg = async () => {\n    try {\n      const response = await fetch(`http://localhost:8000/api/v1/message/allmessage/${chatId}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${authToken}`\n        }\n      });\n      if (!response.ok) {\n        throw new Error('Failed to fetch messages');\n      }\n      const responseData = await response.json();\n      setAllMsg(responseData);\n    } catch (error) {\n      console.error('Failed to fetch messages:', error);\n    }\n  };\n  useEffect(() => {\n    if (chatId) {\n      fetchMsg();\n      socket.emit('join room', chatId);\n      socket.on('message received', newMessage => {\n        setAllMsg(prevMessages => [...prevMessages, newMessage]);\n      });\n      return () => {\n        socket.disconnect();\n      };\n    }\n  }, [chatId]);\n  return {\n    allMsg,\n    setAllMsg\n  };\n}\n_s2(useFetchMsg, \"PhtWOsyxo2vYLfvMrZvFrVBPbM0=\", false, function () {\n  return [useParams];\n});","map":{"version":3,"names":["useEffect","useState","useParams","io","useAddMessage","_s","chatId","addMessage","message","authToken","localStorage","getItem","response","fetch","method","headers","body","JSON","stringify","content","chat","ok","json","Error","error","console","log","useFetchMsg","_s2","allMsg","setAllMsg","socket","fetchMsg","responseData","emit","on","newMessage","prevMessages","disconnect"],"sources":["/Users/shubham/chat/frontend/src/component/Hooks/messageHooks.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport io from 'socket.io-client';\n\nexport function useAddMessage() {\n  const { chatId } = useParams();\n  const addMessage = async (message) => {\n    try {\n      const authToken = localStorage.getItem('token');\n      const response = await fetch('http://localhost:8000/api/v1/message/addmessage', {\n        method: 'POST',\n        headers: {\n          'content-type': 'application/json',\n          'authorization': `Bearer ${authToken}`\n        },\n        body: JSON.stringify({\n          content: message,\n          chat: chatId\n        })\n      });\n      if (response.ok) {\n        return await response.json();\n      }\n      throw new Error('Failed to add message');\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  return { addMessage };\n}\n\nexport function useFetchMsg() {\n  const [allMsg, setAllMsg] = useState([]);\n  const { chatId } = useParams();\n  const authToken = localStorage.getItem('token');\n  const socket = io('http://localhost:8000');\n\n  const fetchMsg = async () => {\n    try {\n      const response = await fetch(`http://localhost:8000/api/v1/message/allmessage/${chatId}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${authToken}`\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch messages');\n      }\n\n      const responseData = await response.json();\n      setAllMsg(responseData);\n    } catch (error) {\n      console.error('Failed to fetch messages:', error);\n    }\n  };\n\n  useEffect(() => {\n    if (chatId) {\n      fetchMsg();\n      socket.emit('join room', chatId);\n\n      socket.on('message received', (newMessage) => {\n        setAllMsg((prevMessages) => [...prevMessages, newMessage]);\n      });\n\n      return () => {\n        socket.disconnect();\n      };\n    }\n  }, [chatId]);\n\n  return { allMsg, setAllMsg };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}